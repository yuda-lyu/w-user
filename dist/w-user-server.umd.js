/*!
 * w-user-server v1.0.22
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("events"),require("dayjs"),require("@hapi/hapi"),require("nodemailer")):"function"==typeof define&&define.amd?define(["events","dayjs","@hapi/hapi","nodemailer"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["w-user-server"]=t(e.events,e.dayjs,e["@hapi/hapi"],e.nodemailer)}(this,(function(e,t,r,n){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=o(e),a=o(t),c=o(r),u=o(n);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){f(i,n,o,a,c,"next",e)}function c(e){f(i,n,o,a,c,"throw",e)}a(void 0)}))}}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function h(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}function d(e){var t={exports:{}};return e(t,t.exports),t.exports}var y=d((function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,i=Object.create(o.prototype),a=new C(n||[]);return i._invoke=function(e,t,r){var n=l;return function(o,i){if(n===h)throw new Error("Generator is already running");if(n===d){if("throw"===o)throw i;return P()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=S(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var u=f(e,t,r);if("normal"===u.type){if(n=r.done?d:v,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=d,r.method="throw",r.arg=u.arg)}}}(e,r,a),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l="suspendedStart",v="suspendedYield",h="executing",d="completed",y={};function g(){}function b(){}function m(){}var w={};u(w,i,(function(){return this}));var j=Object.getPrototypeOf,x=j&&j(j(A([])));x&&x!==r&&n.call(x,i)&&(w=x);var _=m.prototype=g.prototype=Object.create(w);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,i,a,c){var u=f(e[o],e,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"===p(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(l).then((function(e){s.value=e,a(s)}),(function(e){return r("throw",e,a,c)}))}c(u.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function S(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method))return y;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=f(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function A(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:P}}function P(){return{value:t,done:!0}}return b.prototype=m,u(_,"constructor",m),u(m,"constructor",b),b.displayName=u(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},k(O.prototype),u(O.prototype,a,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(_),u(_,c,"Generator"),u(_,i,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"===("undefined"==typeof globalThis?"undefined":p(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})),g=y;var b=function(){this.__data__=[],this.size=0};var m=function(e,t){return e===t||e!=e&&t!=t};var w=function(e,t){for(var r=e.length;r--;)if(m(e[r][0],t))return r;return-1},j=Array.prototype.splice;var x=function(e){var t=this.__data__,r=w(t,e);return!(r<0)&&(r==t.length-1?t.pop():j.call(t,r,1),--this.size,!0)};var _=function(e){var t=this.__data__,r=w(t,e);return r<0?void 0:t[r][1]};var k=function(e){return w(this.__data__,e)>-1};var O=function(e,t){var r=this.__data__,n=w(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function S(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}S.prototype.clear=b,S.prototype.delete=x,S.prototype.get=_,S.prototype.has=k,S.prototype.set=O;var M=S;var E=function(){this.__data__=new M,this.size=0};var C=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var A=function(e){return this.__data__.get(e)};var P=function(e){return this.__data__.has(e)},T="object"==p(v)&&v&&v.Object===Object&&v,L="object"==("undefined"==typeof self?"undefined":p(self))&&self&&self.Object===Object&&self,W=T||L||Function("return this")(),B=W.Symbol,N=Object.prototype,U=N.hasOwnProperty,z=N.toString,H=B?B.toStringTag:void 0;var D=function(e){var t=U.call(e,H),r=e[H];try{e[H]=void 0;var n=!0}catch(e){}var o=z.call(e);return n&&(t?e[H]=r:delete e[H]),o},I=Object.prototype.toString;var F=function(e){return I.call(e)},R=B?B.toStringTag:void 0;var Z=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":R&&R in Object(e)?D(e):F(e)};var Y=function(e){var t=p(e);return null!=e&&("object"==t||"function"==t)};var V,$=function(e){if(!Y(e))return!1;var t=Z(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},G=W["__core-js_shared__"],q=(V=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"";var J=function(e){return!!q&&q in e},X=Function.prototype.toString;var K=function(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Q=/^\[object .+?Constructor\]$/,ee=Function.prototype,te=Object.prototype,re=ee.toString,ne=te.hasOwnProperty,oe=RegExp("^"+re.call(ne).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ie=function(e){return!(!Y(e)||J(e))&&($(e)?oe:Q).test(K(e))};var ae=function(e,t){return null==e?void 0:e[t]};var ce=function(e,t){var r=ae(e,t);return ie(r)?r:void 0},ue=ce(W,"Map"),se=ce(Object,"create");var fe=function(){this.__data__=se?se(null):{},this.size=0};var le=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},pe=Object.prototype.hasOwnProperty;var ve=function(e){var t=this.__data__;if(se){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return pe.call(t,e)?t[e]:void 0},he=Object.prototype.hasOwnProperty;var de=function(e){var t=this.__data__;return se?void 0!==t[e]:he.call(t,e)};var ye=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=se&&void 0===t?"__lodash_hash_undefined__":t,this};function ge(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ge.prototype.clear=fe,ge.prototype.delete=le,ge.prototype.get=ve,ge.prototype.has=de,ge.prototype.set=ye;var be=ge;var me=function(){this.size=0,this.__data__={hash:new be,map:new(ue||M),string:new be}};var we=function(e){var t=p(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var je=function(e,t){var r=e.__data__;return we(t)?r["string"==typeof t?"string":"hash"]:r.map};var xe=function(e){var t=je(this,e).delete(e);return this.size-=t?1:0,t};var _e=function(e){return je(this,e).get(e)};var ke=function(e){return je(this,e).has(e)};var Oe=function(e,t){var r=je(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Se(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Se.prototype.clear=me,Se.prototype.delete=xe,Se.prototype.get=_e,Se.prototype.has=ke,Se.prototype.set=Oe;var Me=Se;var Ee=function(e,t){var r=this.__data__;if(r instanceof M){var n=r.__data__;if(!ue||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Me(n)}return r.set(e,t),this.size=r.size,this};function Ce(e){var t=this.__data__=new M(e);this.size=t.size}Ce.prototype.clear=E,Ce.prototype.delete=C,Ce.prototype.get=A,Ce.prototype.has=P,Ce.prototype.set=Ee;var Ae=Ce;var Pe=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},Te=function(){try{var e=ce(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Le=function(e,t,r){"__proto__"==t&&Te?Te(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},We=Object.prototype.hasOwnProperty;var Be=function(e,t,r){var n=e[t];We.call(e,t)&&m(n,r)&&(void 0!==r||t in e)||Le(e,t,r)};var Ne=function(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var c=t[i],u=n?n(r[c],e[c],c,r,e):void 0;void 0===u&&(u=e[c]),o?Le(r,c,u):Be(r,c,u)}return r};var Ue=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var ze=function(e){return null!=e&&"object"==p(e)};var He=function(e){return ze(e)&&"[object Arguments]"==Z(e)},De=Object.prototype,Ie=De.hasOwnProperty,Fe=De.propertyIsEnumerable,Re=He(function(){return arguments}())?He:function(e){return ze(e)&&Ie.call(e,"callee")&&!Fe.call(e,"callee")},Ze=Re,Ye=Array.isArray;var Ve=function(){return!1},$e=d((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?W.Buffer:void 0,i=(o?o.isBuffer:void 0)||Ve;e.exports=i})),Ge=/^(?:0|[1-9]\d*)$/;var qe=function(e,t){var r=p(e);return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Ge.test(e))&&e>-1&&e%1==0&&e<t};var Je=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Xe={};Xe["[object Float32Array]"]=Xe["[object Float64Array]"]=Xe["[object Int8Array]"]=Xe["[object Int16Array]"]=Xe["[object Int32Array]"]=Xe["[object Uint8Array]"]=Xe["[object Uint8ClampedArray]"]=Xe["[object Uint16Array]"]=Xe["[object Uint32Array]"]=!0,Xe["[object Arguments]"]=Xe["[object Array]"]=Xe["[object ArrayBuffer]"]=Xe["[object Boolean]"]=Xe["[object DataView]"]=Xe["[object Date]"]=Xe["[object Error]"]=Xe["[object Function]"]=Xe["[object Map]"]=Xe["[object Number]"]=Xe["[object Object]"]=Xe["[object RegExp]"]=Xe["[object Set]"]=Xe["[object String]"]=Xe["[object WeakMap]"]=!1;var Ke=function(e){return ze(e)&&Je(e.length)&&!!Xe[Z(e)]};var Qe=function(e){return function(t){return e(t)}},et=d((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r&&T.process,i=function(){try{var e=n&&n.require&&n.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=i})),tt=et&&et.isTypedArray,rt=tt?Qe(tt):Ke,nt=Object.prototype.hasOwnProperty;var ot=function(e,t){var r=Ye(e),n=!r&&Ze(e),o=!r&&!n&&$e(e),i=!r&&!n&&!o&&rt(e),a=r||n||o||i,c=a?Ue(e.length,String):[],u=c.length;for(var s in e)!t&&!nt.call(e,s)||a&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||qe(s,u))||c.push(s);return c},it=Object.prototype;var at=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||it)};var ct=function(e,t){return function(r){return e(t(r))}},ut=ct(Object.keys,Object),st=Object.prototype.hasOwnProperty;var ft=function(e){if(!at(e))return ut(e);var t=[];for(var r in Object(e))st.call(e,r)&&"constructor"!=r&&t.push(r);return t};var lt=function(e){return null!=e&&Je(e.length)&&!$(e)};var pt=function(e){return lt(e)?ot(e):ft(e)};var vt=function(e,t){return e&&Ne(t,pt(t),e)};var ht=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},dt=Object.prototype.hasOwnProperty;var yt=function(e){if(!Y(e))return ht(e);var t=at(e),r=[];for(var n in e)("constructor"!=n||!t&&dt.call(e,n))&&r.push(n);return r};var gt=function(e){return lt(e)?ot(e,!0):yt(e)};var bt=function(e,t){return e&&Ne(t,gt(t),e)},mt=d((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?W.Buffer:void 0,i=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=i?i(r):new e.constructor(r);return e.copy(n),n}}));var wt=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var jt=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i};var xt=function(){return[]},_t=Object.prototype.propertyIsEnumerable,kt=Object.getOwnPropertySymbols,Ot=kt?function(e){return null==e?[]:(e=Object(e),jt(kt(e),(function(t){return _t.call(e,t)})))}:xt;var St=function(e,t){return Ne(e,Ot(e),t)};var Mt=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},Et=ct(Object.getPrototypeOf,Object),Ct=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Mt(t,Ot(e)),e=Et(e);return t}:xt;var At=function(e,t){return Ne(e,Ct(e),t)};var Pt=function(e,t,r){var n=t(e);return Ye(e)?n:Mt(n,r(e))};var Tt=function(e){return Pt(e,pt,Ot)};var Lt=function(e){return Pt(e,gt,Ct)},Wt=ce(W,"DataView"),Bt=ce(W,"Promise"),Nt=ce(W,"Set"),Ut=ce(W,"WeakMap"),zt="[object Map]",Ht="[object Promise]",Dt="[object Set]",It="[object WeakMap]",Ft="[object DataView]",Rt=K(Wt),Zt=K(ue),Yt=K(Bt),Vt=K(Nt),$t=K(Ut),Gt=Z;(Wt&&Gt(new Wt(new ArrayBuffer(1)))!=Ft||ue&&Gt(new ue)!=zt||Bt&&Gt(Bt.resolve())!=Ht||Nt&&Gt(new Nt)!=Dt||Ut&&Gt(new Ut)!=It)&&(Gt=function(e){var t=Z(e),r="[object Object]"==t?e.constructor:void 0,n=r?K(r):"";if(n)switch(n){case Rt:return Ft;case Zt:return zt;case Yt:return Ht;case Vt:return Dt;case $t:return It}return t});var qt=Gt,Jt=Object.prototype.hasOwnProperty;var Xt=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Jt.call(e,"index")&&(r.index=e.index,r.input=e.input),r},Kt=W.Uint8Array;var Qt=function(e){var t=new e.constructor(e.byteLength);return new Kt(t).set(new Kt(e)),t};var er=function(e,t){var r=t?Qt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},tr=/\w*$/;var rr=function(e){var t=new e.constructor(e.source,tr.exec(e));return t.lastIndex=e.lastIndex,t},nr=B?B.prototype:void 0,or=nr?nr.valueOf:void 0;var ir=function(e){return or?Object(or.call(e)):{}};var ar=function(e,t){var r=t?Qt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)};var cr=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return Qt(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return er(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ar(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return rr(e);case"[object Symbol]":return ir(e)}},ur=Object.create,sr=function(){function e(){}return function(t){if(!Y(t))return{};if(ur)return ur(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var fr=function(e){return"function"!=typeof e.constructor||at(e)?{}:sr(Et(e))};var lr=function(e){return ze(e)&&"[object Map]"==qt(e)},pr=et&&et.isMap,vr=pr?Qe(pr):lr;var hr=function(e){return ze(e)&&"[object Set]"==qt(e)},dr=et&&et.isSet,yr=dr?Qe(dr):hr,gr="[object Arguments]",br="[object Function]",mr="[object Object]",wr={};wr[gr]=wr["[object Array]"]=wr["[object ArrayBuffer]"]=wr["[object DataView]"]=wr["[object Boolean]"]=wr["[object Date]"]=wr["[object Float32Array]"]=wr["[object Float64Array]"]=wr["[object Int8Array]"]=wr["[object Int16Array]"]=wr["[object Int32Array]"]=wr["[object Map]"]=wr["[object Number]"]=wr[mr]=wr["[object RegExp]"]=wr["[object Set]"]=wr["[object String]"]=wr["[object Symbol]"]=wr["[object Uint8Array]"]=wr["[object Uint8ClampedArray]"]=wr["[object Uint16Array]"]=wr["[object Uint32Array]"]=!0,wr["[object Error]"]=wr[br]=wr["[object WeakMap]"]=!1;var jr=function e(t,r,n,o,i,a){var c,u=1&r,s=2&r,f=4&r;if(n&&(c=i?n(t,o,i,a):n(t)),void 0!==c)return c;if(!Y(t))return t;var l=Ye(t);if(l){if(c=Xt(t),!u)return wt(t,c)}else{var p=qt(t),v=p==br||"[object GeneratorFunction]"==p;if($e(t))return mt(t,u);if(p==mr||p==gr||v&&!i){if(c=s||v?{}:fr(t),!u)return s?At(t,bt(c,t)):St(t,vt(c,t))}else{if(!wr[p])return i?t:{};c=cr(t,p,u)}}a||(a=new Ae);var h=a.get(t);if(h)return h;a.set(t,c),yr(t)?t.forEach((function(o){c.add(e(o,r,n,o,t,a))})):vr(t)&&t.forEach((function(o,i){c.set(i,e(o,r,n,i,t,a))}));var d=l?void 0:(f?s?Lt:Tt:s?gt:pt)(t);return Pe(d||t,(function(o,i){d&&(o=t[i=o]),Be(c,i,e(o,r,n,i,t,a))})),c};var xr=function(e){return jr(e,5)};var _r=function(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),c=a.length;c--;){var u=a[e?c:++o];if(!1===r(i[u],u,i))break}return t}}();var kr=function(e,t){return function(r,n){if(null==r)return r;if(!lt(r))return e(r,n);for(var o=r.length,i=t?o:-1,a=Object(r);(t?i--:++i<o)&&!1!==n(a[i],i,a););return r}}((function(e,t){return e&&_r(e,t,pt)}));var Or=function(e){return e};var Sr=function(e){return"function"==typeof e?e:Or};var Mr=function(e,t){return(Ye(e)?Pe:kr)(e,Sr(t))};var Er=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o};var Cr=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var Ar=function(e){return this.__data__.has(e)};function Pr(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Me;++t<r;)this.add(e[t])}Pr.prototype.add=Pr.prototype.push=Cr,Pr.prototype.has=Ar;var Tr=Pr;var Lr=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var Wr=function(e,t){return e.has(t)};var Br=function(e,t,r,n,o,i){var a=1&r,c=e.length,u=t.length;if(c!=u&&!(a&&u>c))return!1;var s=i.get(e),f=i.get(t);if(s&&f)return s==t&&f==e;var l=-1,p=!0,v=2&r?new Tr:void 0;for(i.set(e,t),i.set(t,e);++l<c;){var h=e[l],d=t[l];if(n)var y=a?n(d,h,l,t,e,i):n(h,d,l,e,t,i);if(void 0!==y){if(y)continue;p=!1;break}if(v){if(!Lr(t,(function(e,t){if(!Wr(v,t)&&(h===e||o(h,e,r,n,i)))return v.push(t)}))){p=!1;break}}else if(h!==d&&!o(h,d,r,n,i)){p=!1;break}}return i.delete(e),i.delete(t),p};var Nr=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var Ur=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},zr=B?B.prototype:void 0,Hr=zr?zr.valueOf:void 0;var Dr=function(e,t,r,n,o,i,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new Kt(e),new Kt(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return m(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var c=Nr;case"[object Set]":var u=1&n;if(c||(c=Ur),e.size!=t.size&&!u)return!1;var s=a.get(e);if(s)return s==t;n|=2,a.set(e,t);var f=Br(c(e),c(t),n,o,i,a);return a.delete(e),f;case"[object Symbol]":if(Hr)return Hr.call(e)==Hr.call(t)}return!1},Ir=Object.prototype.hasOwnProperty;var Fr=function(e,t,r,n,o,i){var a=1&r,c=Tt(e),u=c.length;if(u!=Tt(t).length&&!a)return!1;for(var s=u;s--;){var f=c[s];if(!(a?f in t:Ir.call(t,f)))return!1}var l=i.get(e),p=i.get(t);if(l&&p)return l==t&&p==e;var v=!0;i.set(e,t),i.set(t,e);for(var h=a;++s<u;){var d=e[f=c[s]],y=t[f];if(n)var g=a?n(y,d,f,t,e,i):n(d,y,f,e,t,i);if(!(void 0===g?d===y||o(d,y,r,n,i):g)){v=!1;break}h||(h="constructor"==f)}if(v&&!h){var b=e.constructor,m=t.constructor;b==m||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof m&&m instanceof m||(v=!1)}return i.delete(e),i.delete(t),v},Rr="[object Arguments]",Zr="[object Array]",Yr="[object Object]",Vr=Object.prototype.hasOwnProperty;var $r=function(e,t,r,n,o,i){var a=Ye(e),c=Ye(t),u=a?Zr:qt(e),s=c?Zr:qt(t),f=(u=u==Rr?Yr:u)==Yr,l=(s=s==Rr?Yr:s)==Yr,p=u==s;if(p&&$e(e)){if(!$e(t))return!1;a=!0,f=!1}if(p&&!f)return i||(i=new Ae),a||rt(e)?Br(e,t,r,n,o,i):Dr(e,t,u,r,n,o,i);if(!(1&r)){var v=f&&Vr.call(e,"__wrapped__"),h=l&&Vr.call(t,"__wrapped__");if(v||h){var d=v?e.value():e,y=h?t.value():t;return i||(i=new Ae),o(d,y,r,n,i)}}return!!p&&(i||(i=new Ae),Fr(e,t,r,n,o,i))};var Gr=function e(t,r,n,o,i){return t===r||(null==t||null==r||!ze(t)&&!ze(r)?t!=t&&r!=r:$r(t,r,n,o,e,i))};var qr=function(e,t,r,n){var o=r.length,i=o,a=!n;if(null==e)return!i;for(e=Object(e);o--;){var c=r[o];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<i;){var u=(c=r[o])[0],s=e[u],f=c[1];if(a&&c[2]){if(void 0===s&&!(u in e))return!1}else{var l=new Ae;if(n)var p=n(s,f,u,e,t,l);if(!(void 0===p?Gr(f,s,3,n,l):p))return!1}}return!0};var Jr=function(e){return e==e&&!Y(e)};var Xr=function(e){for(var t=pt(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,Jr(o)]}return t};var Kr=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}};var Qr=function(e){var t=Xr(e);return 1==t.length&&t[0][2]?Kr(t[0][0],t[0][1]):function(r){return r===e||qr(r,e,t)}};var en=function(e){return"symbol"==p(e)||ze(e)&&"[object Symbol]"==Z(e)},tn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rn=/^\w*$/;var nn=function(e,t){if(Ye(e))return!1;var r=p(e);return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!en(e))||(rn.test(e)||!tn.test(e)||null!=t&&e in Object(t))};function on(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function r(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(on.Cache||Me),r}on.Cache=Me;var an=on;var cn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,un=/\\(\\)?/g,sn=function(e){var t=an(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(cn,(function(e,r,n,o){t.push(n?o.replace(un,"$1"):r||e)})),t})),fn=B?B.prototype:void 0,ln=fn?fn.toString:void 0;var pn=function e(t){if("string"==typeof t)return t;if(Ye(t))return Er(t,e)+"";if(en(t))return ln?ln.call(t):"";var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r};var vn=function(e){return null==e?"":pn(e)};var hn=function(e,t){return Ye(e)?e:nn(e,t)?[e]:sn(vn(e))};var dn=function(e){if("string"==typeof e||en(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t};var yn=function(e,t){for(var r=0,n=(t=hn(t,e)).length;null!=e&&r<n;)e=e[dn(t[r++])];return r&&r==n?e:void 0};var gn=function(e,t,r){var n=null==e?void 0:yn(e,t);return void 0===n?r:n};var bn=function(e,t){return null!=e&&t in Object(e)};var mn=function(e,t,r){for(var n=-1,o=(t=hn(t,e)).length,i=!1;++n<o;){var a=dn(t[n]);if(!(i=null!=e&&r(e,a)))break;e=e[a]}return i||++n!=o?i:!!(o=null==e?0:e.length)&&Je(o)&&qe(a,o)&&(Ye(e)||Ze(e))};var wn=function(e,t){return null!=e&&mn(e,t,bn)};var jn=function(e,t){return nn(e)&&Jr(t)?Kr(dn(e),t):function(r){var n=gn(r,e);return void 0===n&&n===t?wn(r,e):Gr(t,n,3)}};var xn=function(e){return function(t){return null==t?void 0:t[e]}};var _n=function(e){return function(t){return yn(t,e)}};var kn=function(e){return nn(e)?xn(dn(e)):_n(e)};var On=function(e){return"function"==typeof e?e:null==e?Or:"object"==p(e)?Ye(e)?jn(e[0],e[1]):Qr(e):kn(e)};var Sn=function(e,t){var r=-1,n=lt(e)?Array(e.length):[];return kr(e,(function(e,o,i){n[++r]=t(e,o,i)})),n};var Mn=function(e,t){return(Ye(e)?Er:Sn)(e,On(t))},En=B?B.isConcatSpreadable:void 0;var Cn=function(e){return Ye(e)||Ze(e)||!!(En&&e&&e[En])};var An=function e(t,r,n,o,i){var a=-1,c=t.length;for(n||(n=Cn),i||(i=[]);++a<c;){var u=t[a];r>0&&n(u)?r>1?e(u,r-1,n,o,i):Mt(i,u):o||(i[i.length]=u)}return i};var Pn=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return Mt(Ye(r)?wt(r):[r],An(t,1))},Tn=Array.prototype.join;var Ln=function(e,t){return null==e?"":Tn.call(e,t)};var Wn=function(e,t,r,n){if(!Y(e))return e;for(var o=-1,i=(t=hn(t,e)).length,a=i-1,c=e;null!=c&&++o<i;){var u=dn(t[o]),s=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(o!=a){var f=c[u];void 0===(s=n?n(f,u,c):void 0)&&(s=Y(f)?f:qe(t[o+1])?[]:{})}Be(c,u,s),c=c[u]}return e};var Bn=function(e,t,r){for(var n=-1,o=t.length,i={};++n<o;){var a=t[n],c=yn(e,a);r(c,a)&&Wn(i,hn(a,e),c)}return i};var Nn=function(e,t){return Bn(e,t,(function(t,r){return wn(e,r)}))};var Un=function(e){return(null==e?0:e.length)?An(e,1):[]};var zn=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Hn=Math.max;var Dn=function(e,t,r){return t=Hn(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=Hn(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var c=Array(t+1);++o<t;)c[o]=n[o];return c[t]=r(a),zn(e,this,c)}};var In=function(e){return function(){return e}},Fn=Te?function(e,t){return Te(e,"toString",{configurable:!0,enumerable:!1,value:In(t),writable:!0})}:Or,Rn=Date.now;var Zn=function(e){var t=0,r=0;return function(){var n=Rn(),o=16-(n-r);if(r=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},Yn=Zn(Fn);var Vn=function(e){return Yn(Dn(e,void 0,Un),e+"")}((function(e,t){return null==e?{}:Nn(e,t)}));function $n(){var e,t,r=new Promise((function(){e=arguments[0],t=arguments[1]}));return r.resolve=e,r.reject=t,r}var Gn=/\s/;var qn=function(e){for(var t=e.length;t--&&Gn.test(e.charAt(t)););return t},Jn=/^\s+/;var Xn=function(e){return e?e.slice(0,qn(e)+1).replace(Jn,""):e},Kn=/^[-+]0x[0-9a-f]+$/i,Qn=/^0b[01]+$/i,eo=/^0o[0-7]+$/i,to=parseInt;var ro=function(e){if("number"==typeof e)return e;if(en(e))return NaN;if(Y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xn(e);var r=Qn.test(e);return r||eo.test(e)?to(e.slice(2),r?2:8):Kn.test(e)?NaN:+e},no=1/0;var oo=function(e){return e?(e=ro(e))===no||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var io=function(e){var t=oo(e),r=t%1;return t==t?r?t-r:t:0};var ao=function(e){return"number"==typeof e&&e==io(e)};function co(e){return"[object String]"===Object.prototype.toString.call(e)}function uo(e){return!(!co(e)||""===e)}function so(e){var t=!1;return uo(e)?t=!isNaN(Number(e)):function(e){return"[object Number]"===Object.prototype.toString.call(e)}(e)&&(t=!0),t}function fo(e){return so(e)?oo(e):0}function lo(e){return!!so(e)&&(e=fo(e),ao(e))}var po=W.isFinite,vo=Math.min;var ho=function(e){var t=Math[e];return function(e,r){if(e=ro(e),(r=null==r?0:vo(io(r),292))&&po(e)){var n=(vn(e)+"e").split("e"),o=t(n[0]+"e"+(+n[1]+r));return+((n=(vn(o)+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}("round");function yo(e){if(!so(e))return 0;e=fo(e);var t=ho(e);return"0"===String(t)?0:t}function go(e){return!!lo(e)&&yo(e)>0}var bo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),mo=bo.length;function wo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,t=[];e=go(e)?yo(e):32;for(var r=0;r<e;r++)t[r]=bo[0|Math.random()*mo];var n=t.join("");return n}function jo(e){return"[object Object]"===Object.prototype.toString.call(e)}function xo(e){if(jo(e)){for(var t in e)return!0;return!1}return!1}function _o(e,t){if(!uo(e))return"";if(!xo(t))return"";var r=!1;return Mr(t,(function(e,t){co(e)||(r=!0)})),r?"":(Mr(t,(function(t,r){e=function(e,t,r){if(!uo(e))return"";if(!uo(t))return"";if(!co(r))return"";var n=new RegExp(t,"g");return String(e).replace(n,r)}(e,r,t)})),e)}function ko(e,t){return!!jo(e)&&(!(!uo(t)&&!so(t))&&t in e)}function Oo(){return a.default().format("YYYY-MM-DDTHH:mm:ssZ")}function So(e){return"[object Array]"===Object.prototype.toString.call(e)}function Mo(e){return!!function(e){return"[object Undefined]"===Object.prototype.toString.call(e)}(e)||(!!function(e){return"[object Null]"===Object.prototype.toString.call(e)}(e)||(!!function(e){if(jo(e)){for(var t in e)return!1;return!0}return!1}(e)||(!!function(e){return!(!co(e)||""!==e)}(e)||!!function(e){return!!So(e)&&0===e.length}(e))))}function Eo(e){return!!So(e)&&(0!==e.length&&(1!==e.length||!Mo(e[0])))}function Co(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"anyone";if(!uo(e))return!1;if("anyone"!==r&&"all"!==r)return!1;if(co(t)){if(!uo(t))return!1;t=[t]}if(!Eo(t))return!1;var n=!1;if(Mr(t,(function(e){uo(e)||(n=!0)})),n)return!1;function o(e,t){return e.indexOf(t)}var i=0;return Mr(t,(function(t){-1!==o(e,t)&&i++})),"anyone"===r?i>0:"all"===r&&i===t.length}function Ao(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t}function Po(e){return!!lo(e)&&yo(e)>=0}function To(e,t){return uo(e)&&Po(t)?0===(t=yo(t))?e:function(e,t){return uo(e)&&Po(t)?0===(t=yo(t))?"":e.substring(0,t):""}(e,e.length-t):""}function Lo(e,t){if(!uo(e))return"";if(!Po(t))return"";if(0===(t=yo(t)))return"";var r=e.length-t;return r<0&&(r=0),e.substr(r,t)}function Wo(e){return"Z"===Lo(e,1)?(e=To(e,1),"".concat(e,"+00:00")):e}var Bo={checkTZ:function(e){var t;return"Z"===(t=Lo(e,1))||(t=Lo(e,6),!!/[+|-]\d\d:\d\d/.test(t))},delTZ:function(e){return To(e,"Z"===Lo(e,1)?1:6)},normTZ:Wo,sepTZ:function(e){var t=Wo(e);return{t:To(t,6),tz:Lo(t,6)}}};function No(e){if(!uo(e))return!1;if(!Bo.checkTZ(e))return!1;var t=Bo.delTZ(e),r="YYYY-MM-DDTHH:mm:ss";return t===a.default(t,r).format(r)}function Uo(e){return!!uo(e)&&/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)}var zo=h(Object.freeze({__proto__:null,default:{}})),Ho=d((function(e,t){var r;e.exports=(r=r||function(e,t){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==v&&v.crypto&&(r=v.crypto),!r)try{r=zo}catch(e){}var n=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),i={},a=i.lib={},c=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=a.WordArray=c.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||f).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,o=e.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var a=r[i>>>2]>>>24-i%4*8&255;t[n+i>>>2]|=a<<24-(n+i)%4*8}else for(var c=0;c<o;c+=4)t[n+c>>>2]=r[c>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(n());return new u.init(t,e)}}),s=i.enc={},f=s.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new u.init(r,t/2)}},l=s.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new u.init(r,t)}},p=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},h=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,o=n.words,i=n.sigBytes,a=this.blockSize,c=i/(4*a),s=(c=t?e.ceil(c):e.max((0|c)-this._minBufferSize,0))*a,f=e.min(4*s,i);if(s){for(var l=0;l<s;l+=a)this._doProcessBlock(o,l);r=o.splice(0,s),n.sigBytes-=f}return new u.init(r,f)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});a.Hasher=h.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new d.HMAC.init(e,r).finalize(t)}}});var d=i.algo={};return i}(Math),r)})),Do=(d((function(e,t){var r,n,o,i,a,c,u;e.exports=(o=(n=u=Ho).lib,i=o.Base,a=o.WordArray,(c=n.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),c.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=t!=r?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var o=e[n];r.push(o.high),r.push(o.low)}return a.create(r,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),r=t.length,n=0;n<r;n++)t[n]=t[n].clone();return e}}),u)})),d((function(e,t){var r;e.exports=(r=Ho,function(){var e=r,t=e.lib.Hasher,n=e.x64,o=n.Word,i=n.WordArray,a=e.algo;function c(){return o.create.apply(o,arguments)}var u=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],s=[];!function(){for(var e=0;e<80;e++)s[e]=c()}();var f=a.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],a=r[3],c=r[4],f=r[5],l=r[6],p=r[7],v=n.high,h=n.low,d=o.high,y=o.low,g=i.high,b=i.low,m=a.high,w=a.low,j=c.high,x=c.low,_=f.high,k=f.low,O=l.high,S=l.low,M=p.high,E=p.low,C=v,A=h,P=d,T=y,L=g,W=b,B=m,N=w,U=j,z=x,H=_,D=k,I=O,F=S,R=M,Z=E,Y=0;Y<80;Y++){var V,$,G=s[Y];if(Y<16)$=G.high=0|e[t+2*Y],V=G.low=0|e[t+2*Y+1];else{var q=s[Y-15],J=q.high,X=q.low,K=(J>>>1|X<<31)^(J>>>8|X<<24)^J>>>7,Q=(X>>>1|J<<31)^(X>>>8|J<<24)^(X>>>7|J<<25),ee=s[Y-2],te=ee.high,re=ee.low,ne=(te>>>19|re<<13)^(te<<3|re>>>29)^te>>>6,oe=(re>>>19|te<<13)^(re<<3|te>>>29)^(re>>>6|te<<26),ie=s[Y-7],ae=ie.high,ce=ie.low,ue=s[Y-16],se=ue.high,fe=ue.low;$=($=($=K+ae+((V=Q+ce)>>>0<Q>>>0?1:0))+ne+((V+=oe)>>>0<oe>>>0?1:0))+se+((V+=fe)>>>0<fe>>>0?1:0),G.high=$,G.low=V}var le,pe=U&H^~U&I,ve=z&D^~z&F,he=C&P^C&L^P&L,de=A&T^A&W^T&W,ye=(C>>>28|A<<4)^(C<<30|A>>>2)^(C<<25|A>>>7),ge=(A>>>28|C<<4)^(A<<30|C>>>2)^(A<<25|C>>>7),be=(U>>>14|z<<18)^(U>>>18|z<<14)^(U<<23|z>>>9),me=(z>>>14|U<<18)^(z>>>18|U<<14)^(z<<23|U>>>9),we=u[Y],je=we.high,xe=we.low,_e=R+be+((le=Z+me)>>>0<Z>>>0?1:0),ke=ge+de;R=I,Z=F,I=H,F=D,H=U,D=z,U=B+(_e=(_e=(_e=_e+pe+((le+=ve)>>>0<ve>>>0?1:0))+je+((le+=xe)>>>0<xe>>>0?1:0))+$+((le+=V)>>>0<V>>>0?1:0))+((z=N+le|0)>>>0<N>>>0?1:0)|0,B=L,N=W,L=P,W=T,P=C,T=A,C=_e+(ye+he+(ke>>>0<ge>>>0?1:0))+((A=le+ke|0)>>>0<le>>>0?1:0)|0}h=n.low=h+A,n.high=v+C+(h>>>0<A>>>0?1:0),y=o.low=y+T,o.high=d+P+(y>>>0<T>>>0?1:0),b=i.low=b+W,i.high=g+L+(b>>>0<W>>>0?1:0),w=a.low=w+N,a.high=m+B+(w>>>0<N>>>0?1:0),x=c.low=x+z,c.high=j+U+(x>>>0<z>>>0?1:0),k=f.low=k+D,f.high=_+H+(k>>>0<D>>>0?1:0),S=l.low=S+F,l.high=O+I+(S>>>0<F>>>0?1:0),E=p.low=E+Z,p.high=M+R+(E>>>0<Z>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(f),e.HmacSHA512=t._createHmacHelper(f)}(),r.SHA512)}))),Io=d((function(e,t){var r;e.exports=(r=Ho,function(){var e=r,t=e.lib.WordArray;function n(e,r,n){for(var o=[],i=0,a=0;a<r;a++)if(a%4){var c=n[e.charCodeAt(a-1)]<<a%4*2|n[e.charCodeAt(a)]>>>6-a%4*2;o[i>>>2]|=c<<24-i%4*8,i++}return t.create(o,i)}e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var o=[],i=0;i<r;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,c=0;c<4&&i+.75*c<r;c++)o.push(n.charAt(a>>>6*(3-c)&63));var u=n.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(e){var t=e.length,r=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<r.length;i++)o[r.charCodeAt(i)]=i}var a=r.charAt(64);if(a){var c=e.indexOf(a);-1!==c&&(t=c)}return n(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),r.enc.Base64)})),Fo=d((function(e,t){e.exports=Ho.enc.Hex}));var Ro=function(e){return!0===e||!1===e||ze(e)&&"[object Boolean]"==Z(e)};function Zo(e){return Ro(e)}function Yo(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!uo(e))return"";if(!Zo(t))return"";var r=Do(e);return t?r.toString(Io):r.toString(Fo)}function Vo(e){var t,r=Object.prototype.toString.call(e);if(t="[object Promise]"===r)return!0;if("[object Function]"!==r)return!1;try{t="function"!=typeof e.subscribe&&"function"==typeof e.then}catch(e){}return t}function $o(e){return function(){var t=$n(),r=null,n=null;try{r=e.apply(this,arguments)}catch(e){n=e}return null!==n?t.resolve({state:"error",msg:n}):Vo(r)?r.then((function(e){t.resolve({state:"success",msg:e})})).catch((function(e){"cancelled"===gn(e,"reason")?t.resolve({state:"cancelled",msg:""}):t.resolve({state:"error",msg:e})})):t.resolve({state:"success",msg:r}),t}}var Go=function(e,t,r,n){for(var o=e.length,i=r+(n?1:-1);n?i--:++i<o;)if(t(e[i],i,e))return i;return-1};var qo=function(e){return e!=e};var Jo=function(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1};var Xo=function(e,t,r){return t==t?Jo(e,t,r):Go(e,qo,r)};var Ko=function(e,t){return!!(null==e?0:e.length)&&Xo(e,t,0)>-1};var Qo=function(e,t,r){for(var n=-1,o=null==e?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1};var ei=function(){},ti=Nt&&1/Ur(new Nt([,-0]))[1]==1/0?function(e){return new Nt(e)}:ei;var ri=function(e,t,r){var n=-1,o=Ko,i=e.length,a=!0,c=[],u=c;if(r)a=!1,o=Qo;else if(i>=200){var s=t?null:ti(e);if(s)return Ur(s);a=!1,o=Wr,u=new Tr}else u=t?[]:c;e:for(;++n<i;){var f=e[n],l=t?t(f):f;if(f=r||0!==f?f:0,a&&l==l){for(var p=u.length;p--;)if(u[p]===l)continue e;t&&u.push(l),c.push(f)}else o(u,l,r)||(u!==c&&u.push(l),c.push(f))}return c};var ni=function(e,t){return e&&e.length?ri(e,On(t)):[]};var oi=function(e,t){return Gr(e,t)};function ii(e,t){function r(e){return So(e)?e:[e]}if(Mo(e))return!1;if(0===(e=r(e)).length)return!1;if(Mo(e))return!1;if(0===(t=r(t)).length)return!1;for(var n=0;n<e.length;n++)for(var o=0;o<t.length;o++)if(oi(e[n],t[o]))return!0;return!1}function ai(e){var t=[],r=[];(e=xr(e)).port||(e.port=8080),e.apiName||(e.apiName="api"),e.routes||(e.routes=[]);var n=[];function o(t){var r=$n();return Ao(e.authenticate)?e.authenticate(t).then((function(e){r.resolve(e)})):r.resolve(!0),r}function i(){return(i=l(g.mark((function t(r){var i,a,c,u;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=gn(r,"token",""),t.next=3,o(i);case 3:if(!t.sent){t.next=25;break}if(a=gn(r,"func",""),c=gn(r,"input"),"getFuncs"!==a){t.next=15;break}if(!Ao(e.filterFuncs)){t.next=12;break}return t.next=11,e.filterFuncs(i,n);case 11:n=t.sent;case 12:r.output={sys:"sys",funcs:n},t.next=23;break;case 15:if(!ii(n,a)){t.next=22;break}return t.next=18,e.funcs[a](c);case 18:u=t.sent,r.output=u,t.next=23;break;case 22:r.output={err:"can not find: ".concat(a)};case 23:t.next=26;break;case 25:r.output={err:"can not authenticate token: ".concat(i)};case 26:return delete r.input,t.abrupt("return",JSON.stringify(r));case 28:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function a(t){if(Ao(e.onClientChange)){var n=ni(t,"clientId");oi(r,n)||(r=n,e.onClientChange(r,e))}}ko(e,"funcs")&&(n=pt(e.funcs));var u={path:"/"+e.apiName,method:"POST",options:{payload:{maxBytes:1048576e3,timeout:18e4,multipart:!0},timeout:{socket:3e5}},handler:function(e,r){var n=$n(),o=wo(),c=gn(e.payload,"clientId"),u={headers:e.headers,info:e.info};return t.push({clientId:c,connId:o,data:u}),a(t),function(e){return i.apply(this,arguments)}(e.payload).then((function(e){n.resolve(e)})).catch((function(e){n.reject(e)})).finally((function(){a(t=t.filter((function(e){return e.connId!==o})))})),n}};function s(){return(s=l(g.mark((function t(){var r;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=c.default.server({port:e.port,routes:{cors:!0}})).route(u),Mr(e.routes,(function(e){r.route(e)})),t.next=5,r.start();case 5:console.log("Server running at: ".concat(r.info.uri));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.serverHapi?e.serverHapi.route(u):function(){s.apply(this,arguments)}()}function ci(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$n(),r=gn(e,"srcName","system by w-email"),n=gn(e,"srcEmail","");if(!Uo(n))return t.reject("srcEmail is not email"),t;var o=gn(e,"srcPW",""),i=gn(e,"srcHost","smtp.gmail.com"),a=gn(e,"srcPort",465),c=gn(e,"emTitle",""),s=gn(e,"emContent",""),f=gn(e,"emAttachments",[]);jo(f)&&(f=[f]);var l=gn(e,"toEmails",[]);co(l)&&(l=[l]);var p=gn(e,"toEmailsCC",[]);co(p)&&(p=[p]);var v=gn(e,"toEmailsBCC",[]);co(v)&&(v=[v]);var h=u.default.createTransport({host:i,port:a,auth:{user:n,pass:o},secure:465===a}),d={from:"".concat(r," <").concat(n,">"),to:l.join(","),cc:p.join(","),bcc:v.join(","),subject:c,html:s,attachments:f};return h.sendMail(d,(function(e,r){e?t.reject(e):t.resolve(r.response)})),t}var ui='<table style="width:100%;">\n<tbody>\n\n<tr style="display:none;">\n    <td>\n        {emMessage}\n    </td>\n</tr>\n\n<tr>\n    <td style="padding:30px; font-family:\'Microsoft JhengHei\'; background-color:#666; text-align:center;">\n        <a style="color:#aaffff; font-size:24pt; text-decoration:none;" href="{emWebUrl}" target="_blank">{emWebName}</a>\n        <p style="margin:10px 0px 0px 0px; color:#eee; font-size:12pt;">\n            {emWebDescription}\n        </p>\n    </td>\n</tr>\n\n<tr>\n    <td style="padding:20px; font-family:\'Microsoft JhengHei\';">\n        <p style="">{emMessage}</p>\n    </td>\n</tr>\n\n<tr>\n    <td style="padding:20px; font-family:\'Microsoft JhengHei\'; background-color:#f5f5f5; text-align:center;">\n        <p style="color:#f26; font-size:11pt;">【{emLetterDoNotReplayMessage}】</p>\n        <p style="">{emLetterTeamMessage}</p>\n        <p style="padding:1em 0px 0px 0px; color:#aaa;">{emLetterLinks}</p>\n    </td>\n</tr>\n\n</tbody>\n</table>',si='<p>Dear {name} :</p>\n\n<p>Your registration request has been received. Please click the link below to verify your account.</p>\n\n<p><a href="{urlCheckCode}" target="_blank">Confirm Account</a></p>',fi='<p>Dear {name} :</p>\n\n<p>You have received your change password request. Please click the link below to verify your account.</p>\n\n<p><a href="{urlCheckCode}" target="_blank">Confirm Account</a></p>',li='<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-tw">\n\n    <head>\n        <meta http-equiv="content-type" content="text/html charset=UTF-8" />\n        <title>{rdWebName}</title>\n\n        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.slim.js"><\/script>\n\n    </head>\n\n    <body style="padding:0; margin:0;">\n    \n        <div style="display:flex; align-items:center; justify-content:center;">\n            \n            <div style="padding:30px; font-family:\'Microsoft JhengHei\';">\n            \n                <div style="margin:10px 0px 20px 0px; display:flex; align-items:center;">\n\n                    <div style="margin-right:10px;">\n                        {rdLogo}\n                    </div>\n\n                    <div style="margin:-5px 0px 0px 0px;">\n                        <div style="margin:0px 0px 0px 0px; font-size:12pt; color:#999;">Single Sign-On</div>\n                        <div style="margin:-3px 0px 0px 0px; font-size:24pt;">{rdWebName}</div>\n                    </div>\n\n                </div>\n    \n                <div style="padding:20px; text-align:center; background-color:#fee; border-radius:10px;">\n\n                    <div style="">{rdMessage}</div>\n    \n                    <div id="cd" style="margin:10px 0px 0px 0px; font-size:10pt; color:#999; display:none;"></div>\n\n                </div>\n                \n            </div>\n            \n        </div>\n        \n        <script>\n\n            function countdown() {\n                $(\'#cd\').show()\n                let n = 5\n                let tmp = \'{rdCountdownMessage}\'\n                $(\'#cd\').text(tmp.replace(\'{s}\', n))\n                setInterval(function() {\n                    n -= 1\n                    if (n<=0) {\n                        window.location.href = \'{rdWebUrl}\'\n                    }\n                    $(\'#cd\').text(tmp.replace(\'{s}\', n))\n                }, 1000)\n            }\n            if ({rdCountdown}) {\n                countdown()\n            }\n\n        <\/script>\n\n    </body>\n\n</html>',pi='<svg width="64" height="64" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#c8da52;}.cls-2{fill:#995f5b;}</style></defs><title/><path class="cls-1" d="M23.85,38.78c9.63-2,15,2.07,16.22,8.17S38,58.88,28.4,60.86,5.33,54.71,5.21,54.13,14.23,40.76,23.85,38.78Z"/><path class="cls-1" d="M45.72,18.87C51.31,27,49.66,33.45,44.54,37s-11.78,2.78-17.36-5.3S23.83,8,24.31,7.7,40.14,10.78,45.72,18.87Z"/><path class="cls-1" d="M72.6,31.21c-5.26,8.3-11.88,9.33-17.14,6s-7.16-9.75-1.9-18.05,20.45-12.32,21-12S77.86,22.91,72.6,31.21Z"/><path class="cls-1" d="M71.73,60.78c-9.69-1.6-13.22-7.3-12.21-13.44s6.19-10.4,15.88-8.8,19.33,14,19.24,14.59S81.43,62.38,71.73,60.78Z"/><path class="cls-2" d="M57.46,43.08a1,1,0,0,0-1.41-1.41l-6.22,6.21-6.21-6.21a1,1,0,0,0-1.41,1.41l6.62,6.63v5.08l-5.21-5.21A1,1,0,1,0,42.21,51l6.62,6.63V93.78a1,1,0,0,0,2,0V57.62L57.46,51a1,1,0,0,0-1.41-1.41l-5.22,5.21V49.71Z"/><path class="cls-2" d="M75.86,78.39a1,1,0,0,0-1,1V93.78a1,1,0,0,0,2,0V79.39A1,1,0,0,0,75.86,78.39Z"/><path class="cls-1" d="M65.37,77.4c3.88-.8,6,.83,6.53,3.28s-.83,4.8-4.7,5.6-9.28-2.48-9.32-2.71S61.5,78.2,65.37,77.4Z"/><path class="cls-1" d="M74.17,69.39c2.25,3.25,1.58,5.86-.48,7.29s-4.73,1.11-7-2.14S65.36,65,65.56,64.9,71.92,66.14,74.17,69.39Z"/><path class="cls-1" d="M85,74.35c-2.11,3.34-4.78,3.75-6.89,2.41s-2.88-3.92-.77-7.26,8.23-5,8.43-4.83S87.1,71,85,74.35Z"/><path class="cls-1" d="M84.63,86.25c-3.9-.65-5.32-2.94-4.91-5.41s2.49-4.18,6.39-3.54,7.78,5.64,7.74,5.87S88.53,86.89,84.63,86.25Z"/></svg>';function vi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function hi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vi(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function di(e){return e.format("YYYY-MM-DDTHH:mm:ssZ")}function yi(e){return a.default(e,"YYYY-MM-DDTHH:mm:ssZ")}function gi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{state:"success",msg:e}}function bi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{state:"error",msg:e}}var mi="general",wi="yes",ji=["<",">"];return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new i.default.EventEmitter;function r(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];setTimeout((function(){t.emit.apply(t,[e].concat(n)),t.emit("all",{eventName:e,data:[].concat(n)})}),1)}function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(){var n=$n(),o=xr(arguments);function i(e){t&&r(t,{input:o,output:e})}return e.apply(this,arguments).then((function(e){i(e),n.resolve(e)})).catch((function(e){i(e),n.resolve(e)})),n}}if(go((e=xr(e)).port)||(e.port=8080),uo(e.apiName)||(e.apiName="api"),uo(e.authUrl)||(e.authUrl="http://localhost:8080/auth"),uo(e.salt)||(e.salt=""),go(e.timeTokenExp)||(e.timeTokenExp=30),uo(e.webName)||(e.webName=""),uo(e.webUrl)||(e.webUrl=""),uo(e.webDescription)||(e.webDescription=""),uo(e.emSenderName)||(e.emSenderName="WUserServer"),!uo(e.emSenderEmail))return console.log("invalid emSenderEmail"),t;uo(e.emSenderPW)||(e.emSenderPW=""),uo(e.emBCC)||(e.emBCC=""),uo(e.emLetterHtml)||(e.emLetterHtml=ui),uo(e.emLetterTeamMessage)||(e.emLetterTeamMessage="Global-User International Company"),uo(e.emLetterDoNotReplayMessage)||(e.emLetterDoNotReplayMessage="This letter is automatically sent by the system, please do not reply to this email."),So(e.emLetterLinks)||(e.emLetterLinks=[]),uo(e.emSignUpTitle)||(e.emSignUpTitle="Verification letter"),uo(e.emSignUpHtml)||(e.emSignUpHtml=si),uo(e.emResetPWTitle)||(e.emResetPWTitle="Password reset letter"),uo(e.emResetPWHtml)||(e.emResetPWHtml=fi),uo(e.verifyWebHtml)||(e.verifyWebHtml=li),uo(e.verifyWebLogo)||(e.verifyWebLogo=pi),uo(e.verifyWebMsgSuccess)||(e.verifyWebMsgSuccess="Verify successfully"),uo(e.verifyWebMsgExpired)||(e.verifyWebMsgExpired="Code has expired"),uo(e.verifyWebMsgCount)||(e.verifyWebMsgCount="Go to the website automatically after {s} seconds..."),jo(e.funcs)||(e.funcs={}),So(e.routes)||(e.routes=[]);var o=Ao(gn(e,"orm.select",null)),c=Ao(gn(e,"orm.insert",null)),u=Ao(gn(e,"orm.save",null));if(!o||!c||!u)return console.log("invalid orm"),t;var s=e.orm,f={id:{type:"String",public:!0,necessary:!0,exclude:[],canModify:!1},name:{type:"String",public:!0,necessary:!1,exclude:ji,canModify:!0},pwEnc:{type:"String",public:!1,necessary:!0,exclude:[],canModify:!1},email:{type:"String",public:!0,necessary:!0,exclude:ji,canModify:!0},address:{type:"String",public:!0,necessary:!1,exclude:ji,canModify:!0},phone:{type:"String",public:!0,necessary:!1,exclude:ji,canModify:!0},organization:{type:"String",public:!0,necessary:!1,exclude:ji,canModify:!0},position:{type:"String",public:!0,necessary:!1,exclude:ji,canModify:!0},role:{type:"String",public:!0,necessary:!0,exclude:ji,canModify:!1},checkCode:{type:"String",public:!1,necessary:!1,exclude:[],canModify:!1},token:{type:"String",public:!1,necessary:!1,exclude:[],canModify:!1},tokenExp:{type:"String",public:!1,necessary:!1,exclude:[],canModify:!1},timeCreate:{type:"String",public:!1,necessary:!0,exclude:[],canModify:!1},timeLogin:{type:"String",public:!1,necessary:!1,exclude:[],canModify:!1},remark:{type:"String",public:!0,necessary:!1,exclude:[],canModify:!0},active:{type:"String",public:!1,necessary:!0,exclude:[],canModify:!1}},p=$o(s.save);function v(e,t){if(ko(f,e)){var r=f[e].type,n=f[e].exclude;return"String"===r?co(t)?Co(t,n)?bi('can not contain special characters: "<" or ">"'):gi():bi("value is not string: "+t):"Object"===r?jo(t)?gi():bi("value is not object: "+t):bi("type is not defined: "+r)}return bi("invalid key: "+e)}function h(e){return Mr(e,(function(e,t){var r=v(t,e);if("error"===r.state)return r})),gi()}function d(e){return Mr(f,(function(t,r){var n="";"Object"===t.type&&(n={}),ko(e,r)&&null!==e[r]&&void 0!==e[r]||(e[r]=n)})),e}function y(e){return b.apply(this,arguments)}function b(){return(b=l(g.mark((function e(t){var r,n,o,i;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.token,n=t.find,o=$n(),i=null,e.next=5,F(r);case 5:if("error"!==(i=e.sent).state){e.next=9;break}return o.reject(i.msg),e.abrupt("return",o);case 9:return s.select(n).then((function(e){if(e.length>=1){var t=e,r=[];Mr(f,(function(e,t){e.public&&r.push(t)})),t=Mn(t,(function(e){return Vn(e,r)})),o.resolve(t)}else o.reject("can not find user")})).catch((function(e){console.log("selectPublic catch:",e,"find:",n),o.reject("error")})),e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=$o(y);function w(e){return j.apply(this,arguments)}function j(){return(j=l(g.mark((function t(r){var n,o;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=$n(),o=null,uo(r.pwEnc)){t.next=5;break}return n.reject("invalid password"),t.abrupt("return",n);case 5:if(Uo(r.email)){t.next=8;break}return n.reject("invalid email"),t.abrupt("return",n);case 8:return t.next=10,O({email:r.email});case 10:if(!t.sent){t.next=14;break}return n.reject("email has been used"),t.abrupt("return",n);case 14:if("error"!==(o=h(r)).state){t.next=18;break}return n.reject(o.msg),t.abrupt("return",n);case 18:return(r=d(r)).id=wo(),""!==e.salt&&(r.pwEnc=Yo(r.pwEnc+e.salt)),r.checkCode=wo(),r.timeCreate=Oo(),r.role=mi,r.active=wi,s.insert(r).then((function(e){n.resolve({id:r.id,checkCode:r.checkCode})})).catch((function(e){console.log("insert catch:",e,"user:",r),n.reject("error")})),t.abrupt("return",n);case 27:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var x=$o(w);function _(e){var t=$n();return s.select(e).then((function(e){1===e.length?t.resolve(e[0]):e.length>1?t.reject("find ".concat(e.length," users")):t.reject("can not find user")})).catch((function(r){console.log("selectOne catch:",r,"find:",e),t.reject("error")})),t}var k=$o(_);function O(e){var t=$n();return xo(e)?(s.select(e).then((function(e){e.length>=1?t.resolve(!0):t.resolve(!1)})).catch((function(r){console.log("select catch:",r,"find:",e),t.reject("error")})),t):(t.reject("invalid find"),t)}function S(e){return M.apply(this,arguments)}function M(){return(M=l(g.mark((function t(r){var n,o,i,a,c;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=$n(),o=null,t.next=4,x(r);case 4:if("error"!==(o=t.sent).state){t.next=8;break}return n.reject(o.msg),t.abrupt("return",n);case 8:return i=o.msg.id,r.id=i,a=o.msg.checkCode,r.checkCode=a,c="".concat(e.authUrl,"?checkCode=").concat(a),t.next=15,ae(r.name,c,r.email);case 15:if("error"!==(o=t.sent).state){t.next=20;break}return console.log("signUp catch:",o.msg,"emailObj:",{name:r.name,urlCheckCode:c,email:r.email}),n.reject("can not send email"),t.abrupt("return",n);case 20:return n.resolve(r.id),t.abrupt("return",n);case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var E=$o(S);function C(e){return A.apply(this,arguments)}function A(){return(A=l(g.mark((function t(r){var n,o,i,c,u,s,f,l;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.email,o=r.pwEnc,i=$n(),c=null,uo(n)){t.next=6;break}return i.reject("invalid email"),t.abrupt("return",i);case 6:if(uo(o)){t.next=9;break}return i.reject("invalid password"),t.abrupt("return",i);case 9:return u={email:n},t.next=12,k(u);case 12:if("error"!==(c=t.sent).state){t.next=17;break}return console.log("logIn catch:",c.msg,"find:",u),i.reject("email or password is incorrect"),t.abrupt("return",i);case 17:if(""===(s=c.msg).checkCode){t.next=21;break}return i.reject("account is not verified"),t.abrupt("return",i);case 21:if(""!==e.salt&&(o=Yo(o+e.salt)),s.pwEnc===o){t.next=25;break}return i.reject("email or password is incorrect"),t.abrupt("return",i);case 25:if(s.active===wi){t.next=28;break}return i.reject("account is suspended"),t.abrupt("return",i);case 28:return t.next=30,F(s.token);case 30:if("success"!==(c=t.sent).state){t.next=34;break}return i.resolve(s.token),t.abrupt("return",i);case 34:return f=wo(),l={id:s.id,token:f,tokenExp:di(a.default().add(e.timeTokenExp,"minute")),timeLogin:Oo()},t.next=38,p(l);case 38:if("error"!==(c=t.sent).state){t.next=43;break}return console.log("logIn catch:",c.msg,"userModify:",l),i.reject("can not save token"),t.abrupt("return",i);case 43:return i.resolve(f),t.abrupt("return",i);case 45:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var P=$o(C);function T(e){return L.apply(this,arguments)}function L(){return(L=l(g.mark((function e(t){var r,n,o,i,a;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=$n(),n=null,uo(t)){e.next=5;break}return r.reject("invalid token"),e.abrupt("return",r);case 5:return o={token:t},e.next=8,k(o);case 8:if("error"!==(n=e.sent).state){e.next=13;break}return console.log("logOut catch:",n.msg,"find:",o),r.reject("invalid token"),e.abrupt("return",r);case 13:return i=n.msg,a={id:i.id,token:"",tokenExp:""},e.next=17,p(a);case 17:if("error"!==(n=e.sent).state){e.next=22;break}return console.log("logOut catch:",n.msg,"userModify:",a),r.reject("can not update token"),e.abrupt("return",r);case 22:return r.resolve("ok"),e.abrupt("return",r);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W=$o(T);function B(t){var r=$n();if(!uo(t))return r.reject(e.verifyWebMsgExpired),r;var n={checkCode:t};return _(n).then((function(e){var t={id:e.id,checkCode:""};return s.save(t)})).then((function(t){r.resolve(e.verifyWebMsgSuccess)})).catch((function(t){console.log("verifyCheckCode catch:",t,"find:",n),r.reject(e.verifyWebMsgExpired)})),r}function N(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"false",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=e.verifyWebHtml;return o=_o(o,{"{rdWebName}":e.webName,"{rdWebDescription}":e.webDescription,"{rdWebUrl}":e.webUrl,"{rdLogo}":e.verifyWebLogo,"{rdMessage}":t,"{rdCountdown}":r,"{rdCountdownMessage}":n})}function U(t){var n=$n(),o=e.verifyWebMsgCount;return B(t).then((function(e){r("verifyCheckCodeAndGetHtml",{state:"success",msg:e,checkCode:t}),n.resolve(N(e,"true",o))})).catch((function(e){r("verifyCheckCodeAndGetHtml",{state:"error",msg:e,checkCode:t}),n.resolve(N(e,"false",""))})),n}function z(t){var r=$n();if(No(t)){var n=a.default(),o=yi(t).diff(n,"minute");o>0?r.resolve("ok"):o>e.timeTokenExp?(console.log("verifyTokenExp error:","iMinutes="+o,">","timeTokenExp="+e.timeTokenExp),r.reject("invalid tokenExp")):r.reject("token expired")}else r.reject("no expire time for token");return r}var H=$o(z);function D(e){return I.apply(this,arguments)}function I(){return(I=l(g.mark((function e(t){var r,n,o,i;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=$n(),n=null,uo(t)){e.next=5;break}return r.reject("invalid token"),e.abrupt("return",r);case 5:return o={token:t},e.next=8,k(o);case 8:if("error"!==(n=e.sent).state){e.next=13;break}return console.log("isValidToken catch:",n.msg,"find:",o),r.reject("invalid token"),e.abrupt("return",r);case 13:if(i=n.msg,"error"!==(n=H(i.tokenExp)).state){e.next=18;break}return r.reject(n.msg),e.abrupt("return",r);case 18:return r.resolve("ok"),e.abrupt("return",r);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F=$o(D);function R(e){return Z.apply(this,arguments)}function Z(){return(Z=l(g.mark((function t(r){var n,o,i,c,u;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=$n(),o=null,uo(r)){t.next=5;break}return n.reject("invalid token"),t.abrupt("return",n);case 5:return i={token:r},t.next=8,k(i);case 8:if("error"!==(o=t.sent).state){t.next=13;break}return console.log("refreshTokenExp catch:",o.msg,"find:",i),n.reject("invalid token"),t.abrupt("return",n);case 13:if(c=o.msg,"error"!==(o=z(c.tokenExp)).state){t.next=18;break}return n.reject(o.err),t.abrupt("return",n);case 18:return u={id:c.id,tokenExp:di(a.default().add(e.timeTokenExp,"minute"))},t.next=21,p(u);case 21:if("error"!==(o=t.sent).state){t.next=26;break}return console.log("refreshTokenExp catch:",o.msg,"userModify:",u),n.reject("can not update token"),t.abrupt("return",n);case 26:return n.resolve("ok"),t.abrupt("return",n);case 28:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Y=$o(R);function V(e){return $.apply(this,arguments)}function $(){return($=l(g.mark((function e(t){var r,n,o,i;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=$n(),n=null,o={token:t},e.next=5,k(o);case 5:if("error"!==(n=e.sent).state){e.next=10;break}return console.log("getUserFromToken catch:",n.msg,"find:",o),r.reject("invalid token"),e.abrupt("return",r);case 10:return i=n.msg,r.resolve(i),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e){return q.apply(this,arguments)}function q(){return(q=l(g.mark((function t(r){var n,o,i,a,c,u,s,f;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.email,o=r.pwEnc,i=r.pwEncNew,a=$n(),c=null,uo(n)){t.next=6;break}return a.reject("invalid email"),t.abrupt("return",a);case 6:if(uo(o)){t.next=9;break}return a.reject("invalid old password"),t.abrupt("return",a);case 9:if(uo(i)){t.next=12;break}return a.reject("invalid new password"),t.abrupt("return",a);case 12:return u={email:n},t.next=15,k(u);case 15:if("error"!==(c=t.sent).state){t.next=20;break}return console.log("changePW catch:",c.msg,"find:",u),a.reject("email or password is incorrect"),t.abrupt("return",a);case 20:if(""===(s=c.msg).checkCode){t.next=24;break}return a.reject("account is not verified"),t.abrupt("return",a);case 24:if(s.active===wi){t.next=27;break}return a.reject("account is suspended"),t.abrupt("return",a);case 27:if(""!==e.salt&&(o=Yo(o+e.salt),i=Yo(i+e.salt)),s.pwEnc===o){t.next=31;break}return a.reject("email or password is incorrect"),t.abrupt("return",a);case 31:return f={id:s.id,pwEnc:i},t.next=34,p(f);case 34:if("error"!==(c=t.sent).state){t.next=39;break}return console.log("changePW catch:",c.msg,"userModify:",f),a.reject("can not update password"),t.abrupt("return",a);case 39:return a.resolve("ok"),t.abrupt("return",a);case 41:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var J=$o(G);function X(e){return K.apply(this,arguments)}function K(){return(K=l(g.mark((function t(r){var n,o,i,a,c,u,s,f,l;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.email,o=r.pwEncNew,i=$n(),a=null,uo(n)){t.next=6;break}return i.reject("invalid email"),t.abrupt("return",i);case 6:if(uo(o)){t.next=9;break}return i.reject("invalid new password"),t.abrupt("return",i);case 9:return c={email:n},t.next=12,k(c);case 12:if("error"!==(a=t.sent).state){t.next=17;break}return console.log("resetPW catch:",a.msg,"find:",c),i.reject("email is incorrect"),t.abrupt("return",i);case 17:if((u=a.msg).active===wi){t.next=21;break}return i.reject("account is suspended"),t.abrupt("return",i);case 21:return""!==e.salt&&(o=Yo(o+e.salt)),s=wo(),f={id:u.id,pwEnc:o,checkCode:s},t.next=26,p(f);case 26:if("error"!==(a=t.sent).state){t.next=31;break}return console.log("resetPW catch:",a.msg,"userModify:",f),i.reject("can not update password"),t.abrupt("return",i);case 31:return l="".concat(e.authUrl,"?checkCode=").concat(s),t.next=34,ue(u.name,l,u.email);case 34:if("error"!==(a=t.sent).state){t.next=39;break}return console.log("resetPW catch:",a.msg,"emailObj:",{name:u.name,urlCheckCode:l,email:u.email}),i.reject("can not send email"),t.abrupt("return",i);case 39:return i.resolve("ok"),t.abrupt("return",i);case 41:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Q=$o(X);function ee(e){return te.apply(this,arguments)}function te(){return(te=l(g.mark((function e(t){var r,n,o,i,a,c,u;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.token,n=t.user,o=$n(),i=null,e.next=5,F(r);case 5:if("error"!==(i=e.sent).state){e.next=9;break}return o.reject(i.msg),e.abrupt("return",o);case 9:if("error"!==(i=h(n)).state){e.next=13;break}return o.reject(i.msg),e.abrupt("return",o);case 13:return e.next=15,V(r);case 15:if(a=e.sent,c={id:a.id},u=!1,Mr(f,(function(e,t){e.canModify&&n[t]&&a[t]!==n[t]&&(u=!0,c[t]=n[t])})),u){e.next=22;break}return o.resolve("no change"),e.abrupt("return",o);case 22:return e.next=24,p(c);case 24:if("error"!==(i=e.sent).state){e.next=29;break}return console.log("modifyInfor catch:",i.msg,"userModify:",c),o.reject("can not modify"),e.abrupt("return",o);case 29:return o.resolve("ok"),e.abrupt("return",o);case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=$o(ee);function ne(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={srcName:e.emSenderName,srcEmail:e.emSenderEmail,srcPW:e.emSenderPW,emTitle:t,emContent:r,toEmails:n,toEmailsCC:o,toEmailsBCC:i};return new ci(a)}function oe(t,r,n,o,i){var a=e.emLetterHtml,c=e.webName,u=e.webUrl,s=e.emLetterLinks;return""!==c&&""!==u&&(s=Pn({name:c,url:u},s)),s=Mn(s,(function(e){var t=gn(e,"name",""),r=gn(e,"url","");return'<a style="text-decoration:none" href="'.concat(r,'" target="_blank" >').concat(t,"</a>")})),s="| ".concat(Ln(s," | ")," |"),ne(t,a=_o(a,{"{emMessage}":r,"{emWebName}":c,"{emWebUrl}":u,"{emWebDescription}":e.webDescription,"{emLetterDoNotReplayMessage}":e.emLetterDoNotReplayMessage,"{emLetterTeamMessage}":e.emLetterTeamMessage,"{emLetterLinks}":s}),n,o,i)}function ie(t,r,n){var o=e.emSignUpTitle,i=e.emSignUpHtml;return oe(o,i=_o(i,{"{name}":t,"{urlCheckCode}":r}),n,[],e.emBCC)}var ae=$o(ie);function ce(t,r,n){var o=e.emResetPWTitle,i=e.emResetPWHtml;return oe(o,i=_o(i,{"{name}":t,"{urlCheckCode}":r}),n,[],e.emBCC)}var ue=$o(ce),se={select:function(e){return n(m,"selectPublic")(e)},signUp:function(e){return n(E,"signUp")(e)},logIn:function(e){return n(P,"logIn")(e)},refreshTokenExp:function(e){return n(Y,"refreshTokenExp")(e)},isValidToken:function(e){return n(F,"isValidToken")(e)},logOut:function(e){return n(W,"logOut")(e)},changePW:function(e){return n(J,"changePW")(e)},resetPW:function(e){return n(Q,"resetPW")(e)},modifyInfor:function(e){return n(re,"modifyInfor")(e)}};Mr(e.funcs,(function(t,r){ko(se,r)?console.log("invalid func: "+r):se[r]=e.funcs[r]}));var fe,le=[{method:"GET",path:"/auth",handler:(fe=l(g.mark((function e(t,r){var n;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query.checkCode,e.abrupt("return",U(n));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return fe.apply(this,arguments)})}];return Mr(e.routes,(function(e){le.push(e)})),new ai(e=hi(hi({},e),{},{onClientChange:function(e,t){r("clientChange",e.length,e)},funcs:se,routes:le})),t}}));
//# sourceMappingURL=w-user-server.umd.js.map
